<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>vaspirin.poscar API documentation</title>
    <meta name="description" content="" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#vaspirin.poscar.Atom">Atom</a></span>
        
          
  <ul>
    <li class="mono"><a href="#vaspirin.poscar.Atom.__init__">__init__</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#vaspirin.poscar.POSCAR">POSCAR</a></span>
        
          
  <ul>
    <li class="mono"><a href="#vaspirin.poscar.POSCAR.__init__">__init__</a></li>
    <li class="mono"><a href="#vaspirin.poscar.POSCAR.cart2dir">cart2dir</a></li>
    <li class="mono"><a href="#vaspirin.poscar.POSCAR.dir2cart">dir2cart</a></li>
    <li class="mono"><a href="#vaspirin.poscar.POSCAR.getAtomNumbers">getAtomNumbers</a></li>
    <li class="mono"><a href="#vaspirin.poscar.POSCAR.getAtomSymbols">getAtomSymbols</a></li>
    <li class="mono"><a href="#vaspirin.poscar.POSCAR.getBasis">getBasis</a></li>
    <li class="mono"><a href="#vaspirin.poscar.POSCAR.getComment">getComment</a></li>
    <li class="mono"><a href="#vaspirin.poscar.POSCAR.getCoordinates">getCoordinates</a></li>
    <li class="mono"><a href="#vaspirin.poscar.POSCAR.getLattice">getLattice</a></li>
    <li class="mono"><a href="#vaspirin.poscar.POSCAR.getSelectiveDynamics">getSelectiveDynamics</a></li>
    <li class="mono"><a href="#vaspirin.poscar.POSCAR.writePoscar">writePoscar</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">vaspirin.poscar</span> module</h1>
  
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar" class="source">
    <div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">Atom</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Class to describe an atom interfaced with POSCAR files. Works like a struct do group certain qualities from the atomic representation.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">dynamicsOptions</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">element</span>	
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		The chemical element being represented</span>
<span class="sd">		&#39;&#39;&#39;</span>
			
		<span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Position of the atom</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">dynamicsOptions</span> <span class="o">=</span> <span class="n">dynamicsOptions</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Selective dynamics options</span>
<span class="sd">		&#39;&#39;&#39;</span>

	
	
<span class="k">class</span> <span class="nc">POSCAR</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Class to import and describe POSCAR files. Contains the following information:</span>
<span class="sd">	 </span>
<span class="sd">	 - unit cell dimensions</span>
<span class="sd">	 - basis constituents and their positions</span>
<span class="sd">	 - selective dynamics for each atom</span>
<span class="sd">	 </span>
<span class="sd">	Each atom is represented by its class.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the lattice vectors (self.lattice), the atomic basis (self.basis),</span>
<span class="sd">		the atom summary (which atoms are represented and how many of each one are there, self.atomSummary)</span>
<span class="sd">		and the coordinates of the system (cartesian or direct). The comment is also included.</span>
<span class="sd">		&#39;&#39;&#39;</span>
	
		<span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getComment</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Comment for the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSelectiveDynamics</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Verify if the selective dynamics options is set</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">lattice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLattice</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Lattice vectors of the unit cell</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">atomSymbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomSymbols</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Chemical elements used in the unit cell</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomNumbers</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Number of atoms of each material being used to represent the unit cell</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="c1">## self.allAtoms is a list of atomic symbols</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">allAtoms</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">)):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">allAtoms</span> <span class="o">+=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atomSymbols</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCoordinates</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBasis</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>			
		
		
	<span class="k">def</span> <span class="nf">getComment</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the comment from the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="c1">## The comment is always the first line</span>
				<span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
	
	
	<span class="k">def</span> <span class="nf">getSelectiveDynamics</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Verify whether the Selective Dynamics option is set</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="n">dynBoolean</span> <span class="o">=</span> <span class="bp">False</span>
				
				<span class="c1">## Go to the 8th (index 7) line and check if there is a &#39;selective dynamics&#39; option</span>
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
						<span class="n">dynamics</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
						<span class="k">if</span> <span class="n">dynamics</span> <span class="o">==</span> <span class="s1">&#39;selective&#39;</span><span class="p">:</span>
							<span class="c1">## There is, indeed, a &#39;selective dynamics&#39; option</span>
							<span class="n">dynBoolean</span> <span class="o">=</span> <span class="bp">True</span>
							
					<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
						<span class="k">break</span>
					
			<span class="k">return</span> <span class="n">dynBoolean</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
			
			
	<span class="k">def</span> <span class="nf">getLattice</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the lattice vectors from the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="c1">## lattice is a vector of vectors, namely a matrix containing the lattice vectors</span>
				<span class="n">lattice</span> <span class="o">=</span> <span class="p">[]</span>
				
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="c1">## Go to the second line (index 1) to get the multiplier</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
						<span class="n">multiplier</span> <span class="o">=</span> <span class="nb">float</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
					<span class="c1">## Get the lattice vectors</span>
					<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
						<span class="c1">## Separates the vector coordinates using multiple spaces as divider.</span>
						<span class="c1">## Then, multiplies it by the multiplier and transform it into a vector</span>
						<span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">multiplier</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
						
						<span class="c1">## Includes the new vector into the lattice</span>
						<span class="n">lattice</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
					<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
						<span class="k">break</span>
					
				<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lattice</span><span class="p">)</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
	
	<span class="k">def</span> <span class="nf">getAtomSymbols</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the atomic symbols from the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="c1">## The atomic symbols are located on the 6th line of the POSCAR file,</span>
					<span class="c1">## and are separated by spaces</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
						<span class="n">lineSymbols</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
						<span class="k">return</span> <span class="n">lineSymbols</span>							
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
	
	<span class="k">def</span> <span class="nf">getAtomNumbers</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the number of atoms of each element from the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="c1">## The 7th line contains the number of atoms of each element</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
						<span class="n">lineNumbers</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
						<span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lineNumbers</span><span class="p">]</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
			
			
	<span class="k">def</span> <span class="nf">getCoordinates</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the coordinates (direct or cartesian) from the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				
				<span class="c1">## It is important to check whether the selective dynamics are on or off</span>
				<span class="c1">## to make sure we select the correct line</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span><span class="p">:</span>
					<span class="n">addLine</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">addLine</span> <span class="o">=</span> <span class="mi">0</span>
				
				<span class="c1">## Get the coordinates system (direct or cartesian) from the POSCAR file</span>
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">):</span>
						<span class="n">coordinates</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
					<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">7</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">):</span>
						<span class="k">break</span>
				
				<span class="k">return</span> <span class="n">coordinates</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
	
	<span class="k">def</span> <span class="nf">getBasis</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the basis from the POSCAR file</span>
<span class="sd">		</span>
<span class="sd">		After all definitions are set within the POSCAR class, we import all properties of all atoms. Each atom is described using a well-defined coordinate system, a symbol and its selective dynamics options.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="c1">## To ensure we get the correct lines</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span><span class="p">:</span>
					<span class="n">addLine</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">addLine</span> <span class="o">=</span> <span class="mi">0</span>
					
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">)</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="n">addLine</span> <span class="o">+</span> <span class="nb">sum</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">)):</span>
						<span class="c1">## l represents the line containing the information of the atom</span>
						<span class="n">l</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
						
						<span class="c1">## pos is the position of the atom in the specified coordinates</span>
						<span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">])])</span>
						
						<span class="c1">## If is there selective dynamics, import it.										</span>
						<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span><span class="p">:</span>
							<span class="n">dyn</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">dyn</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">]</span>											
						
						<span class="c1">## The index of this atom can be related to the number of the line (i)</span>
						<span class="n">thisAtomIndex</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="p">(</span><span class="mi">9</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">)</span>
						
						<span class="c1">## Creates an atom using the Atom class and the information collected</span>
						<span class="n">thisAtom</span> <span class="o">=</span> <span class="n">Atom</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allAtoms</span><span class="p">[</span><span class="n">thisAtomIndex</span><span class="p">],</span> <span class="n">pos</span><span class="p">,</span> <span class="n">dyn</span><span class="p">)</span>
						<span class="n">atoms</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">thisAtom</span><span class="p">)</span>
						
					<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="n">addLine</span> <span class="o">+</span> <span class="nb">sum</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">)):</span>
						<span class="k">break</span>
			
			<span class="k">return</span> <span class="n">atoms</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
	
	<span class="k">def</span> <span class="nf">dir2cart</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Convert direct to cartesian coordinates</span>
<span class="sd">		</span>
<span class="sd">		Demonstration of the formula:</span>
<span class="sd">		</span>
<span class="sd">		c1_vec = d_11 * a1_vec + d_12 * a2_vec + d_13 * a3_vec</span>
<span class="sd">		c2_vec = d_21 * a1_vec + d_22 * a2_vec + d_23 * a3_vec</span>
<span class="sd">		c3_vec = d_31 * a1_vec + d_32 * a2_vec + d_33 * a3_vec</span>
<span class="sd">		</span>
<span class="sd">		[c1_vec c2_vec c3_vec] = [a1_vec a2_vec a3_vec] * [d1_vec d2_vec d3_vec]</span>
<span class="sd">		C = (A)*D</span>
<span class="sd">		</span>
<span class="sd">		Our matrix self.lattice, however, represents the transpose of the A matrix, since it is written this way on the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">==</span> <span class="s1">&#39;direct&#39;</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">:</span>
				<span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="s1">&#39;cartesian&#39;</span>	
				
		<span class="k">return</span>
	
	<span class="k">def</span> <span class="nf">cart2dir</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Convert direct to cartesian coordinates</span>
<span class="sd">		</span>
<span class="sd">		Demonstration of the formula (see function dir2cart):</span>
<span class="sd">		</span>
<span class="sd">		D = inv(A)*C</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">==</span> <span class="s1">&#39;cartesian&#39;</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">:</span>
				<span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">transpose</span><span class="p">()),</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="s1">&#39;direct&#39;</span>
			
		<span class="k">return</span>
	
	<span class="k">def</span> <span class="nf">writePoscar</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outputFilename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Writes the POSCAR class to outputFilename.</span>
<span class="sd">		Selective Dynamics is always written, and the coordinates are preserved.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">outputFilename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fOut</span><span class="p">:</span>
			<span class="c1">## Write comment</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">))</span>
			
			<span class="c1">## Multiplier</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;1.00</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			
			<span class="c1">## justSpace allows us to format the POSCAR file beautifully, with blank spaces</span>
			<span class="n">justSpace</span> <span class="o">=</span> <span class="mi">10</span>
			
			<span class="c1">## Lattice vectors</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
			
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
			
			<span class="c1">## Atom symbols</span>
			<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomSymbols</span><span class="p">:</span>
				<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">eachAtom</span><span class="p">)</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			
			<span class="c1">## Atom numbers</span>
			<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">:</span>
				<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">eachAtom</span><span class="p">)</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;Selective Dynamics</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span>
			
			<span class="c1">#print ([x.position for x in self.basis])</span>
			
			<span class="c1">## Prints all atoms and their positions</span>
			<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">:</span>
				<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 1.8f</span><span class="s2"> </span><span class="si">% 1.8f</span><span class="s2"> </span><span class="si">% 1.8f</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
				<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">eachAtom</span><span class="o">.</span><span class="n">dynamicsOptions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">dynamicsOptions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">dynamicsOptions</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="vaspirin.poscar.Atom" class="name">class <span class="ident">Atom</span></p>
      
  
    <div class="desc"><p>Class to describe an atom interfaced with POSCAR files. Works like a struct do group certain qualities from the atomic representation.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.Atom', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.Atom" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Atom</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Class to describe an atom interfaced with POSCAR files. Works like a struct do group certain qualities from the atomic representation.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">dynamicsOptions</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">element</span>	
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		The chemical element being represented</span>
<span class="sd">		&#39;&#39;&#39;</span>
			
		<span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Position of the atom</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">dynamicsOptions</span> <span class="o">=</span> <span class="n">dynamicsOptions</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Selective dynamics options</span>
<span class="sd">		&#39;&#39;&#39;</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#vaspirin.poscar.Atom">Atom</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.Atom.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, element, position, dynamicsOptions)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.Atom.__init__', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.Atom.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">dynamicsOptions</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">element</span>	
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	The chemical element being represented</span>
<span class="sd">	&#39;&#39;&#39;</span>
		
	<span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Position of the atom</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">dynamicsOptions</span> <span class="o">=</span> <span class="n">dynamicsOptions</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Selective dynamics options</span>
<span class="sd">	&#39;&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="vaspirin.poscar.Atom.dynamicsOptions" class="name">var <span class="ident">dynamicsOptions</span></p>
            

            
  
    <div class="desc"><p>Selective dynamics options</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="vaspirin.poscar.Atom.element" class="name">var <span class="ident">element</span></p>
            

            
  
    <div class="desc"><p>The chemical element being represented</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="vaspirin.poscar.Atom.position" class="name">var <span class="ident">position</span></p>
            

            
  
    <div class="desc"><p>Position of the atom</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="vaspirin.poscar.POSCAR" class="name">class <span class="ident">POSCAR</span></p>
      
  
    <div class="desc"><p>Class to import and describe POSCAR files. Contains the following information:</p>
<ul>
<li>unit cell dimensions</li>
<li>basis constituents and their positions</li>
<li>selective dynamics for each atom</li>
</ul>
<p>Each atom is represented by its class.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">POSCAR</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Class to import and describe POSCAR files. Contains the following information:</span>
<span class="sd">	 </span>
<span class="sd">	 - unit cell dimensions</span>
<span class="sd">	 - basis constituents and their positions</span>
<span class="sd">	 - selective dynamics for each atom</span>
<span class="sd">	 </span>
<span class="sd">	Each atom is represented by its class.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the lattice vectors (self.lattice), the atomic basis (self.basis),</span>
<span class="sd">		the atom summary (which atoms are represented and how many of each one are there, self.atomSummary)</span>
<span class="sd">		and the coordinates of the system (cartesian or direct). The comment is also included.</span>
<span class="sd">		&#39;&#39;&#39;</span>
	
		<span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getComment</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Comment for the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSelectiveDynamics</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Verify if the selective dynamics options is set</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">lattice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLattice</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Lattice vectors of the unit cell</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">atomSymbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomSymbols</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Chemical elements used in the unit cell</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomNumbers</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Number of atoms of each material being used to represent the unit cell</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="c1">## self.allAtoms is a list of atomic symbols</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">allAtoms</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">)):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">allAtoms</span> <span class="o">+=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atomSymbols</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCoordinates</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBasis</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>			
		
		
	<span class="k">def</span> <span class="nf">getComment</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the comment from the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="c1">## The comment is always the first line</span>
				<span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
	
	
	<span class="k">def</span> <span class="nf">getSelectiveDynamics</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Verify whether the Selective Dynamics option is set</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="n">dynBoolean</span> <span class="o">=</span> <span class="bp">False</span>
				
				<span class="c1">## Go to the 8th (index 7) line and check if there is a &#39;selective dynamics&#39; option</span>
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
						<span class="n">dynamics</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
						<span class="k">if</span> <span class="n">dynamics</span> <span class="o">==</span> <span class="s1">&#39;selective&#39;</span><span class="p">:</span>
							<span class="c1">## There is, indeed, a &#39;selective dynamics&#39; option</span>
							<span class="n">dynBoolean</span> <span class="o">=</span> <span class="bp">True</span>
							
					<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
						<span class="k">break</span>
					
			<span class="k">return</span> <span class="n">dynBoolean</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
			
			
	<span class="k">def</span> <span class="nf">getLattice</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the lattice vectors from the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="c1">## lattice is a vector of vectors, namely a matrix containing the lattice vectors</span>
				<span class="n">lattice</span> <span class="o">=</span> <span class="p">[]</span>
				
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="c1">## Go to the second line (index 1) to get the multiplier</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
						<span class="n">multiplier</span> <span class="o">=</span> <span class="nb">float</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
					<span class="c1">## Get the lattice vectors</span>
					<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
						<span class="c1">## Separates the vector coordinates using multiple spaces as divider.</span>
						<span class="c1">## Then, multiplies it by the multiplier and transform it into a vector</span>
						<span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">multiplier</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
						
						<span class="c1">## Includes the new vector into the lattice</span>
						<span class="n">lattice</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
					<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
						<span class="k">break</span>
					
				<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lattice</span><span class="p">)</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
	
	<span class="k">def</span> <span class="nf">getAtomSymbols</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the atomic symbols from the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="c1">## The atomic symbols are located on the 6th line of the POSCAR file,</span>
					<span class="c1">## and are separated by spaces</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
						<span class="n">lineSymbols</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
						<span class="k">return</span> <span class="n">lineSymbols</span>							
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
	
	<span class="k">def</span> <span class="nf">getAtomNumbers</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the number of atoms of each element from the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="c1">## The 7th line contains the number of atoms of each element</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
						<span class="n">lineNumbers</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
						<span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lineNumbers</span><span class="p">]</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
			
			
	<span class="k">def</span> <span class="nf">getCoordinates</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the coordinates (direct or cartesian) from the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				
				<span class="c1">## It is important to check whether the selective dynamics are on or off</span>
				<span class="c1">## to make sure we select the correct line</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span><span class="p">:</span>
					<span class="n">addLine</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">addLine</span> <span class="o">=</span> <span class="mi">0</span>
				
				<span class="c1">## Get the coordinates system (direct or cartesian) from the POSCAR file</span>
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">):</span>
						<span class="n">coordinates</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
					<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">7</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">):</span>
						<span class="k">break</span>
				
				<span class="k">return</span> <span class="n">coordinates</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
	
	<span class="k">def</span> <span class="nf">getBasis</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the basis from the POSCAR file</span>
<span class="sd">		</span>
<span class="sd">		After all definitions are set within the POSCAR class, we import all properties of all atoms. Each atom is described using a well-defined coordinate system, a symbol and its selective dynamics options.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">try</span><span class="p">:</span>
			<span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="c1">## To ensure we get the correct lines</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span><span class="p">:</span>
					<span class="n">addLine</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">addLine</span> <span class="o">=</span> <span class="mi">0</span>
					
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">)</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="n">addLine</span> <span class="o">+</span> <span class="nb">sum</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">)):</span>
						<span class="c1">## l represents the line containing the information of the atom</span>
						<span class="n">l</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
						
						<span class="c1">## pos is the position of the atom in the specified coordinates</span>
						<span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">])])</span>
						
						<span class="c1">## If is there selective dynamics, import it.										</span>
						<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span><span class="p">:</span>
							<span class="n">dyn</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">dyn</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">]</span>											
						
						<span class="c1">## The index of this atom can be related to the number of the line (i)</span>
						<span class="n">thisAtomIndex</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="p">(</span><span class="mi">9</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">)</span>
						
						<span class="c1">## Creates an atom using the Atom class and the information collected</span>
						<span class="n">thisAtom</span> <span class="o">=</span> <span class="n">Atom</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allAtoms</span><span class="p">[</span><span class="n">thisAtomIndex</span><span class="p">],</span> <span class="n">pos</span><span class="p">,</span> <span class="n">dyn</span><span class="p">)</span>
						<span class="n">atoms</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">thisAtom</span><span class="p">)</span>
						
					<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="n">addLine</span> <span class="o">+</span> <span class="nb">sum</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">)):</span>
						<span class="k">break</span>
			
			<span class="k">return</span> <span class="n">atoms</span>
				
		<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
			<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">FileNotFoundError</span>
	
	<span class="k">def</span> <span class="nf">dir2cart</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Convert direct to cartesian coordinates</span>
<span class="sd">		</span>
<span class="sd">		Demonstration of the formula:</span>
<span class="sd">		</span>
<span class="sd">		c1_vec = d_11 * a1_vec + d_12 * a2_vec + d_13 * a3_vec</span>
<span class="sd">		c2_vec = d_21 * a1_vec + d_22 * a2_vec + d_23 * a3_vec</span>
<span class="sd">		c3_vec = d_31 * a1_vec + d_32 * a2_vec + d_33 * a3_vec</span>
<span class="sd">		</span>
<span class="sd">		[c1_vec c2_vec c3_vec] = [a1_vec a2_vec a3_vec] * [d1_vec d2_vec d3_vec]</span>
<span class="sd">		C = (A)*D</span>
<span class="sd">		</span>
<span class="sd">		Our matrix self.lattice, however, represents the transpose of the A matrix, since it is written this way on the POSCAR file</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">==</span> <span class="s1">&#39;direct&#39;</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">:</span>
				<span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="s1">&#39;cartesian&#39;</span>	
				
		<span class="k">return</span>
	
	<span class="k">def</span> <span class="nf">cart2dir</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Convert direct to cartesian coordinates</span>
<span class="sd">		</span>
<span class="sd">		Demonstration of the formula (see function dir2cart):</span>
<span class="sd">		</span>
<span class="sd">		D = inv(A)*C</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">==</span> <span class="s1">&#39;cartesian&#39;</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">:</span>
				<span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">transpose</span><span class="p">()),</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="s1">&#39;direct&#39;</span>
			
		<span class="k">return</span>
	
	<span class="k">def</span> <span class="nf">writePoscar</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outputFilename</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Writes the POSCAR class to outputFilename.</span>
<span class="sd">		Selective Dynamics is always written, and the coordinates are preserved.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">outputFilename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fOut</span><span class="p">:</span>
			<span class="c1">## Write comment</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">))</span>
			
			<span class="c1">## Multiplier</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;1.00</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			
			<span class="c1">## justSpace allows us to format the POSCAR file beautifully, with blank spaces</span>
			<span class="n">justSpace</span> <span class="o">=</span> <span class="mi">10</span>
			
			<span class="c1">## Lattice vectors</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
			
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
			
			<span class="c1">## Atom symbols</span>
			<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomSymbols</span><span class="p">:</span>
				<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">eachAtom</span><span class="p">)</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			
			<span class="c1">## Atom numbers</span>
			<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">:</span>
				<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">eachAtom</span><span class="p">)</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;Selective Dynamics</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span>
			
			<span class="c1">#print ([x.position for x in self.basis])</span>
			
			<span class="c1">## Prints all atoms and their positions</span>
			<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">:</span>
				<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 1.8f</span><span class="s2"> </span><span class="si">% 1.8f</span><span class="s2"> </span><span class="si">% 1.8f</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
				<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">eachAtom</span><span class="o">.</span><span class="n">dynamicsOptions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">dynamicsOptions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">dynamicsOptions</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#vaspirin.poscar.POSCAR">POSCAR</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.POSCAR.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, filename)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the lattice vectors (self.lattice), the atomic basis (self.basis),
the atom summary (which atoms are represented and how many of each one are there, self.atomSummary)
and the coordinates of the system (cartesian or direct). The comment is also included.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR.__init__', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Get the lattice vectors (self.lattice), the atomic basis (self.basis),</span>
<span class="sd">	the atom summary (which atoms are represented and how many of each one are there, self.atomSummary)</span>
<span class="sd">	and the coordinates of the system (cartesian or direct). The comment is also included.</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getComment</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Comment for the POSCAR file</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSelectiveDynamics</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Verify if the selective dynamics options is set</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">lattice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLattice</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Lattice vectors of the unit cell</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">atomSymbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomSymbols</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Chemical elements used in the unit cell</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomNumbers</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Number of atoms of each material being used to represent the unit cell</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="c1">## self.allAtoms is a list of atomic symbols</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">allAtoms</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">)):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">allAtoms</span> <span class="o">+=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atomSymbols</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
	
	<span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCoordinates</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBasis</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span>			
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.POSCAR.cart2dir">
    <p>def <span class="ident">cart2dir</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Convert direct to cartesian coordinates</p>
<p>Demonstration of the formula (see function dir2cart):</p>
<p>D = inv(A)*C</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR.cart2dir', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR.cart2dir" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cart2dir</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Convert direct to cartesian coordinates</span>
<span class="sd">	</span>
<span class="sd">	Demonstration of the formula (see function dir2cart):</span>
<span class="sd">	</span>
<span class="sd">	D = inv(A)*C</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">==</span> <span class="s1">&#39;cartesian&#39;</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">:</span>
			<span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">transpose</span><span class="p">()),</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="s1">&#39;direct&#39;</span>
		
	<span class="k">return</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.POSCAR.dir2cart">
    <p>def <span class="ident">dir2cart</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Convert direct to cartesian coordinates</p>
<p>Demonstration of the formula:</p>
<p>c1_vec = d_11 * a1_vec + d_12 * a2_vec + d_13 * a3_vec
c2_vec = d_21 * a1_vec + d_22 * a2_vec + d_23 * a3_vec
c3_vec = d_31 * a1_vec + d_32 * a2_vec + d_33 * a3_vec</p>
<p>[c1_vec c2_vec c3_vec] = [a1_vec a2_vec a3_vec] * [d1_vec d2_vec d3_vec]
C = (A)*D</p>
<p>Our matrix self.lattice, however, represents the transpose of the A matrix, since it is written this way on the POSCAR file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR.dir2cart', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR.dir2cart" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dir2cart</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Convert direct to cartesian coordinates</span>
<span class="sd">	</span>
<span class="sd">	Demonstration of the formula:</span>
<span class="sd">	</span>
<span class="sd">	c1_vec = d_11 * a1_vec + d_12 * a2_vec + d_13 * a3_vec</span>
<span class="sd">	c2_vec = d_21 * a1_vec + d_22 * a2_vec + d_23 * a3_vec</span>
<span class="sd">	c3_vec = d_31 * a1_vec + d_32 * a2_vec + d_33 * a3_vec</span>
<span class="sd">	</span>
<span class="sd">	[c1_vec c2_vec c3_vec] = [a1_vec a2_vec a3_vec] * [d1_vec d2_vec d3_vec]</span>
<span class="sd">	C = (A)*D</span>
<span class="sd">	</span>
<span class="sd">	Our matrix self.lattice, however, represents the transpose of the A matrix, since it is written this way on the POSCAR file</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">==</span> <span class="s1">&#39;direct&#39;</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">:</span>
			<span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="s1">&#39;cartesian&#39;</span>	
			
	<span class="k">return</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.POSCAR.getAtomNumbers">
    <p>def <span class="ident">getAtomNumbers</span>(</p><p>self, filename)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the number of atoms of each element from the POSCAR file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR.getAtomNumbers', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR.getAtomNumbers" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getAtomNumbers</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Get the number of atoms of each element from the POSCAR file</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
				<span class="c1">## The 7th line contains the number of atoms of each element</span>
				<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
					<span class="n">lineNumbers</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
					<span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lineNumbers</span><span class="p">]</span>
			
	<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
		<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">FileNotFoundError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.POSCAR.getAtomSymbols">
    <p>def <span class="ident">getAtomSymbols</span>(</p><p>self, filename)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the atomic symbols from the POSCAR file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR.getAtomSymbols', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR.getAtomSymbols" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getAtomSymbols</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Get the atomic symbols from the POSCAR file</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
				<span class="c1">## The atomic symbols are located on the 6th line of the POSCAR file,</span>
				<span class="c1">## and are separated by spaces</span>
				<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
					<span class="n">lineSymbols</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
					<span class="k">return</span> <span class="n">lineSymbols</span>							
			
	<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
		<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">FileNotFoundError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.POSCAR.getBasis">
    <p>def <span class="ident">getBasis</span>(</p><p>self, filename)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the basis from the POSCAR file</p>
<p>After all definitions are set within the POSCAR class, we import all properties of all atoms. Each atom is described using a well-defined coordinate system, a symbol and its selective dynamics options.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR.getBasis', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR.getBasis" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getBasis</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Get the basis from the POSCAR file</span>
<span class="sd">	</span>
<span class="sd">	After all definitions are set within the POSCAR class, we import all properties of all atoms. Each atom is described using a well-defined coordinate system, a symbol and its selective dynamics options.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="c1">## To ensure we get the correct lines</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span><span class="p">:</span>
				<span class="n">addLine</span> <span class="o">=</span> <span class="mi">1</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">addLine</span> <span class="o">=</span> <span class="mi">0</span>
				
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">)</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="n">addLine</span> <span class="o">+</span> <span class="nb">sum</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">)):</span>
					<span class="c1">## l represents the line containing the information of the atom</span>
					<span class="n">l</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
					
					<span class="c1">## pos is the position of the atom in the specified coordinates</span>
					<span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">])])</span>
					
					<span class="c1">## If is there selective dynamics, import it.										</span>
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span><span class="p">:</span>
						<span class="n">dyn</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">dyn</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">]</span>											
					
					<span class="c1">## The index of this atom can be related to the number of the line (i)</span>
					<span class="n">thisAtomIndex</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="p">(</span><span class="mi">9</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">)</span>
					
					<span class="c1">## Creates an atom using the Atom class and the information collected</span>
					<span class="n">thisAtom</span> <span class="o">=</span> <span class="n">Atom</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allAtoms</span><span class="p">[</span><span class="n">thisAtomIndex</span><span class="p">],</span> <span class="n">pos</span><span class="p">,</span> <span class="n">dyn</span><span class="p">)</span>
					<span class="n">atoms</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">thisAtom</span><span class="p">)</span>
					
				<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="n">addLine</span> <span class="o">+</span> <span class="nb">sum</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">)):</span>
					<span class="k">break</span>
		
		<span class="k">return</span> <span class="n">atoms</span>
			
	<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
		<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">FileNotFoundError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.POSCAR.getComment">
    <p>def <span class="ident">getComment</span>(</p><p>self, filename)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the comment from the POSCAR file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR.getComment', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR.getComment" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getComment</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Get the comment from the POSCAR file</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="c1">## The comment is always the first line</span>
			<span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			
	<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
		<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">FileNotFoundError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.POSCAR.getCoordinates">
    <p>def <span class="ident">getCoordinates</span>(</p><p>self, filename)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the coordinates (direct or cartesian) from the POSCAR file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR.getCoordinates', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR.getCoordinates" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getCoordinates</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Get the coordinates (direct or cartesian) from the POSCAR file</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			
			<span class="c1">## It is important to check whether the selective dynamics are on or off</span>
			<span class="c1">## to make sure we select the correct line</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamics</span><span class="p">:</span>
				<span class="n">addLine</span> <span class="o">=</span> <span class="mi">1</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">addLine</span> <span class="o">=</span> <span class="mi">0</span>
			
			<span class="c1">## Get the coordinates system (direct or cartesian) from the POSCAR file</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">):</span>
					<span class="n">coordinates</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
				<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">7</span> <span class="o">+</span> <span class="n">addLine</span><span class="p">):</span>
					<span class="k">break</span>
			
			<span class="k">return</span> <span class="n">coordinates</span>
			
	<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
		<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">FileNotFoundError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.POSCAR.getLattice">
    <p>def <span class="ident">getLattice</span>(</p><p>self, filename)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the lattice vectors from the POSCAR file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR.getLattice', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR.getLattice" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getLattice</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Get the lattice vectors from the POSCAR file</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="c1">## lattice is a vector of vectors, namely a matrix containing the lattice vectors</span>
			<span class="n">lattice</span> <span class="o">=</span> <span class="p">[]</span>
			
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
				<span class="c1">## Go to the second line (index 1) to get the multiplier</span>
				<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">multiplier</span> <span class="o">=</span> <span class="nb">float</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
				<span class="c1">## Get the lattice vectors</span>
				<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
					<span class="c1">## Separates the vector coordinates using multiple spaces as divider.</span>
					<span class="c1">## Then, multiplies it by the multiplier and transform it into a vector</span>
					<span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">multiplier</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
					
					<span class="c1">## Includes the new vector into the lattice</span>
					<span class="n">lattice</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
				<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
					<span class="k">break</span>
				
			<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lattice</span><span class="p">)</span>
			
	<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
		<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">FileNotFoundError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.POSCAR.getSelectiveDynamics">
    <p>def <span class="ident">getSelectiveDynamics</span>(</p><p>self, filename)</p>
    </div>
    

    
  
    <div class="desc"><p>Verify whether the Selective Dynamics option is set</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR.getSelectiveDynamics', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR.getSelectiveDynamics" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getSelectiveDynamics</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Verify whether the Selective Dynamics option is set</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="n">dynBoolean</span> <span class="o">=</span> <span class="bp">False</span>
			
			<span class="c1">## Go to the 8th (index 7) line and check if there is a &#39;selective dynamics&#39; option</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
					<span class="n">dynamics</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
					<span class="k">if</span> <span class="n">dynamics</span> <span class="o">==</span> <span class="s1">&#39;selective&#39;</span><span class="p">:</span>
						<span class="c1">## There is, indeed, a &#39;selective dynamics&#39; option</span>
						<span class="n">dynBoolean</span> <span class="o">=</span> <span class="bp">True</span>
						
				<span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
					<span class="k">break</span>
				
		<span class="k">return</span> <span class="n">dynBoolean</span>
			
	<span class="k">except</span> <span class="n">FileNotFoundError</span><span class="p">:</span>
		<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Please specify a valid filename!&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">FileNotFoundError</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="vaspirin.poscar.POSCAR.writePoscar">
    <p>def <span class="ident">writePoscar</span>(</p><p>self, outputFilename)</p>
    </div>
    

    
  
    <div class="desc"><p>Writes the POSCAR class to outputFilename.
Selective Dynamics is always written, and the coordinates are preserved.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-vaspirin.poscar.POSCAR.writePoscar', this);">Show source &equiv;</a></p>
  <div id="source-vaspirin.poscar.POSCAR.writePoscar" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">writePoscar</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outputFilename</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Writes the POSCAR class to outputFilename.</span>
<span class="sd">	Selective Dynamics is always written, and the coordinates are preserved.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	
	<span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="n">outputFilename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fOut</span><span class="p">:</span>
		<span class="c1">## Write comment</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">))</span>
		
		<span class="c1">## Multiplier</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;1.00</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		
		<span class="c1">## justSpace allows us to format the POSCAR file beautifully, with blank spaces</span>
		<span class="n">justSpace</span> <span class="o">=</span> <span class="mi">10</span>
		
		<span class="c1">## Lattice vectors</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
		
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 4.8f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">justSpace</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
		
		<span class="c1">## Atom symbols</span>
		<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomSymbols</span><span class="p">:</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">eachAtom</span><span class="p">)</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		
		<span class="c1">## Atom numbers</span>
		<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomNumbers</span><span class="p">:</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">eachAtom</span><span class="p">)</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;Selective Dynamics</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span>
		
		<span class="c1">#print ([x.position for x in self.basis])</span>
		
		<span class="c1">## Prints all atoms and their positions</span>
		<span class="k">for</span> <span class="n">eachAtom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">:</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">% 1.8f</span><span class="s2"> </span><span class="si">% 1.8f</span><span class="s2"> </span><span class="si">% 1.8f</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
			<span class="n">fOut</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">eachAtom</span><span class="o">.</span><span class="n">dynamicsOptions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">dynamicsOptions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">eachAtom</span><span class="o">.</span><span class="n">dynamicsOptions</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="vaspirin.poscar.POSCAR.allAtoms" class="name">var <span class="ident">allAtoms</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="vaspirin.poscar.POSCAR.atomNumbers" class="name">var <span class="ident">atomNumbers</span></p>
            

            
  
    <div class="desc"><p>Number of atoms of each material being used to represent the unit cell</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="vaspirin.poscar.POSCAR.atomSymbols" class="name">var <span class="ident">atomSymbols</span></p>
            

            
  
    <div class="desc"><p>Chemical elements used in the unit cell</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="vaspirin.poscar.POSCAR.basis" class="name">var <span class="ident">basis</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="vaspirin.poscar.POSCAR.comment" class="name">var <span class="ident">comment</span></p>
            

            
  
    <div class="desc"><p>Comment for the POSCAR file</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="vaspirin.poscar.POSCAR.coordinates" class="name">var <span class="ident">coordinates</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="vaspirin.poscar.POSCAR.dynamics" class="name">var <span class="ident">dynamics</span></p>
            

            
  
    <div class="desc"><p>Verify if the selective dynamics options is set</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="vaspirin.poscar.POSCAR.lattice" class="name">var <span class="ident">lattice</span></p>
            

            
  
    <div class="desc"><p>Lattice vectors of the unit cell</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
